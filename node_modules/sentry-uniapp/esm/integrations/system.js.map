{"version":3,"file":"system.js","sourceRoot":"","sources":["../../src/integrations/system.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,uBAAuB,EAAE,aAAa,EAAE,MAAM,cAAc,CAAC;AAGtE,OAAO,EAAE,OAAO,IAAI,cAAc,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAC;AAClE,OAAO,EAAE,WAAW,EAAE,MAAM,YAAY,CAAC;AAEzC,gBAAgB;AAChB;IAAA;QACE;;WAEG;QACI,SAAI,GAAW,MAAM,CAAC,EAAE,CAAC;IA+ElC,CAAC;IAxEC;;OAEG;IACI,0BAAS,GAAhB;QACE,uBAAuB,CAAC,UAAC,KAAY;YACnC,IAAI,aAAa,EAAE,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBAC1C,IAAI;oBACF,IAAM,UAAU,GAAG,GAAG,CAAC,iBAAiB,EAAE,CAAA;oBAGxC,IAAA,YAAY,GAkBV,UAAU,aAlBA,EAAE,QAAQ;oBACtB,cAAc,GAiBZ,UAAU,eAjBE,EAAE,gBAAgB;oBAChC,OAAO,GAgBL,UAAU,QAhBL,EAAE,UAAU;oBACnB,KAAK,GAeH,UAAU,MAfP,EACL,QAAQ,GAcN,UAAU,SAdJ,EACR,KAAK,GAaH,UAAU,MAbP,EACL,UAAU,GAYR,UAAU,WAZF,EACV,QAAQ,GAWN,UAAU,SAXJ,EACR,YAAY,GAUV,UAAU,aAVA,EACZ,WAAW,GAST,UAAU,YATD,EACX,eAAe,GAQb,UAAU,gBARG,EACf,MAAM,GAOJ,UAAU,OAPN,EACN,OAAO,GAML,UAAU,QANL,EACP,YAAY,GAKV,UAAU,aALA,EACZ,WAAW,GAIT,UAAU,YAJD,EACX,GAAG,GAGD,UAAU,IAHT,EAAE,SAAS;oBACd,OAAO,GAEL,UAAU,QAFL,EAAE,UAAU;oBACnB,eAAe,GACb,UAAU,gBADG,CACF;oBAEf,yCAAyC;oBACzC,IAAM,UAAU,GAAG,WAAW,CAAC;oBACzB,IAAA,KAAA,OAA8B,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,IAAA,EAA9C,UAAU,QAAA,EAAE,aAAa,QAAqB,CAAC;oBAEtD,6BACK,KAAK,KACR,QAAQ,wBACH,KAAK,CAAC,QAAQ,KACjB,MAAM,EAAE;gCACN,KAAK,OAAA;gCACL,aAAa,EAAE,YAAY,IAAI,cAAc,IAAI,OAAO;gCACxD,KAAK,OAAA;gCACL,UAAU,EAAE,UAAU;6BACvB,EACD,EAAE,EAAE;gCACF,IAAI,EAAE,UAAU,IAAI,MAAM;gCAC1B,OAAO,EAAE,aAAa,IAAI,MAAM;6BACjC,EACD,KAAK,aACH,UAAU,YAAA;gCACV,QAAQ,UAAA;gCACR,QAAQ,UAAA;gCACR,YAAY,cAAA;gCACZ,WAAW,aAAA;gCACX,eAAe,iBAAA;gCACf,OAAO,SAAA;gCACP,YAAY,cAAA;gCACZ,WAAW,aAAA;gCACX,eAAe,iBAAA,EACf,GAAG,EAAE,GAAG,IAAI,OAAO,IAAI,cAAc,IAClC,UAAU,QAGjB;iBACH;gBAAC,OAAO,CAAC,EAAE;oBACV,OAAO,CAAC,IAAI,CAAC,yCAAuC,CAAG,CAAC,CAAC;iBAC1D;aACF;YAED,OAAO,KAAK,CAAC;QACf,CAAC,CAAC,CAAC;IACL,CAAC;IA5ED;;OAEG;IACW,SAAE,GAAW,QAAQ,CAAC;IA0EtC,aAAC;CAAA,AAnFD,IAmFC;SAnFY,MAAM","sourcesContent":["import { addGlobalEventProcessor, getCurrentHub } from \"@sentry/core\";\nimport { Event, Integration } from \"@sentry/types\";\n\nimport { appName as currentAppName, sdk } from \"../crossPlatform\";\nimport { SDK_VERSION } from \"../version\";\n\n/** UserAgent */\nexport class System implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public name: string = System.id;\n\n  /**\n   * @inheritDoc\n   */\n  public static id: string = \"System\";\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    addGlobalEventProcessor((event: Event) => {\n      if (getCurrentHub().getIntegration(System)) {\n        try {\n          const systemInfo = sdk.getSystemInfoSync()\n\n          const {\n            batteryLevel, // 微信小程序\n            currentBattery, // 支付宝小程序、 钉钉小程序\n            battery, // 字节跳动小程序\n            brand,\n            language,\n            model,\n            pixelRatio,\n            platform,\n            screenHeight,\n            screenWidth,\n            statusBarHeight,\n            system,\n            version,\n            windowHeight,\n            windowWidth,\n            app, // 支付宝小程序\n            appName, // 字节跳动小程序\n            fontSizeSetting, // 支付宝小程序、 钉钉小程序、微信小程序\n          } = systemInfo;\n\n          // tslint:disable-next-line:variable-name\n          const SDKVersion = SDK_VERSION;\n          const [systemName, systemVersion] = system.split(\" \");\n\n          return {\n            ...event,\n            contexts: {\n              ...event.contexts,\n              device: {\n                brand,\n                battery_level: batteryLevel || currentBattery || battery,\n                model,\n                screen_dpi: pixelRatio\n              },\n              os: {\n                name: systemName || system,\n                version: systemVersion || system\n              },\n              extra: {\n                SDKVersion,\n                language,\n                platform,\n                screenHeight,\n                screenWidth,\n                statusBarHeight,\n                version,\n                windowHeight,\n                windowWidth,\n                fontSizeSetting,\n                app: app || appName || currentAppName,\n                ...systemInfo,\n              }\n            }\n          };\n        } catch (e) {\n          console.warn(`sentry-uniapp get system info fail: ${e}`);\n        }\n      }\n\n      return event;\n    });\n  }\n}\n"]}